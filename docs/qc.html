<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Quality control pipeline</title>

<script src="site_libs/header-attrs-2.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="my-style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">UKBB 200k Exome QC</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="qc.html">Detailed QC</a>
</li>
<li>
  <a href="qc_summary.html">QC Summary</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/astheeggeggs/SAIGE_gene_munging">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Quality control pipeline</h1>

</div>


<p><br> On this page we detail the quality control (QC) pipeline for the UK Biobank exomes before starting our analyses. Further plots and the underlying <a href="https://github.com/astheeggeggs/SAIGE_gene_munging/tree/main/QC_scripts">code</a> can be found on the SAIGE gene munging github <a href="https://github.com/astheeggeggs/SAIGE_gene_munging">repository</a>.</p>
<p>We first summarise the collection of samples for which the exome sequence data is available, splitting across UKBB centres and sequencing batch.</p>
<p><br></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
UKBB centre
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Barts
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
4,238
</td>
<td style="text-align:right;">
4,303
</td>
</tr>
<tr>
<td style="text-align:left;">
Birmingham
</td>
<td style="text-align:right;">
9,558
</td>
<td style="text-align:right;">
5,249
</td>
<td style="text-align:right;">
14,807
</td>
</tr>
<tr>
<td style="text-align:left;">
Bristol
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
14,890
</td>
<td style="text-align:right;">
15,000
</td>
</tr>
<tr>
<td style="text-align:left;">
Bury
</td>
<td style="text-align:right;">
1,765
</td>
<td style="text-align:right;">
8,990
</td>
<td style="text-align:right;">
10,755
</td>
</tr>
<tr>
<td style="text-align:left;">
Cardiff
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
6,258
</td>
<td style="text-align:right;">
6,357
</td>
</tr>
<tr>
<td style="text-align:left;">
Croydon
</td>
<td style="text-align:right;">
7,005
</td>
<td style="text-align:right;">
6,825
</td>
<td style="text-align:right;">
13,830
</td>
</tr>
<tr>
<td style="text-align:left;">
Edinburgh
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
5,682
</td>
<td style="text-align:right;">
5,741
</td>
</tr>
<tr>
<td style="text-align:left;">
Glasgow
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
6,017
</td>
<td style="text-align:right;">
6,111
</td>
</tr>
<tr>
<td style="text-align:left;">
Hounslow
</td>
<td style="text-align:right;">
5,471
</td>
<td style="text-align:right;">
7,786
</td>
<td style="text-align:right;">
13,257
</td>
</tr>
<tr>
<td style="text-align:left;">
Leeds
</td>
<td style="text-align:right;">
2,110
</td>
<td style="text-align:right;">
14,151
</td>
<td style="text-align:right;">
16,261
</td>
</tr>
<tr>
<td style="text-align:left;">
Liverpool
</td>
<td style="text-align:right;">
4,899
</td>
<td style="text-align:right;">
9,050
</td>
<td style="text-align:right;">
13,949
</td>
</tr>
<tr>
<td style="text-align:left;">
Manchester
</td>
<td style="text-align:right;">
1,823
</td>
<td style="text-align:right;">
4,049
</td>
<td style="text-align:right;">
5,872
</td>
</tr>
<tr>
<td style="text-align:left;">
Middlesborough
</td>
<td style="text-align:right;">
103
</td>
<td style="text-align:right;">
7,009
</td>
<td style="text-align:right;">
7,112
</td>
</tr>
<tr>
<td style="text-align:left;">
Newcastle
</td>
<td style="text-align:right;">
153
</td>
<td style="text-align:right;">
12,219
</td>
<td style="text-align:right;">
12,372
</td>
</tr>
<tr>
<td style="text-align:left;">
Nottingham
</td>
<td style="text-align:right;">
1,609
</td>
<td style="text-align:right;">
10,726
</td>
<td style="text-align:right;">
12,335
</td>
</tr>
<tr>
<td style="text-align:left;">
Oxford
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
5,087
</td>
<td style="text-align:right;">
5,136
</td>
</tr>
<tr>
<td style="text-align:left;">
Reading
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
9,896
</td>
<td style="text-align:right;">
9,963
</td>
</tr>
<tr>
<td style="text-align:left;">
Sheffield
</td>
<td style="text-align:right;">
13,901
</td>
<td style="text-align:right;">
5,280
</td>
<td style="text-align:right;">
19,181
</td>
</tr>
<tr>
<td style="text-align:left;">
Stockport (pilot)
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
75
</td>
</tr>
<tr>
<td style="text-align:left;">
Stoke
</td>
<td style="text-align:right;">
840
</td>
<td style="text-align:right;">
6,340
</td>
<td style="text-align:right;">
7,180
</td>
</tr>
<tr>
<td style="text-align:left;">
Swansea
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
760
</td>
<td style="text-align:right;">
776
</td>
</tr>
<tr>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
Wrexham
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
182
</td>
<td style="text-align:right;">
259
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
Total
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
49,956
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
150,687
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
200,643
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Finally, the split by <a href="https://biobank.ndph.ox.ac.uk/showcase/field.cgi?id=21000">Data-Field 21000</a> was as follows:</p>
<p><br></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Self reported ethnicity
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Asian or Asian British
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
Black or Black British
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
Mixed
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
African
</td>
<td style="text-align:right;">
337
</td>
<td style="text-align:right;">
905
</td>
<td style="text-align:right;">
1,242
</td>
</tr>
<tr>
<td style="text-align:left;">
Any other Asian background
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
558
</td>
<td style="text-align:right;">
760
</td>
</tr>
<tr>
<td style="text-align:left;">
Any other Black background
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
47
</td>
</tr>
<tr>
<td style="text-align:left;">
Any other mixed background
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
332
</td>
<td style="text-align:right;">
451
</td>
</tr>
<tr>
<td style="text-align:left;">
Any other white background
</td>
<td style="text-align:right;">
1,708
</td>
<td style="text-align:right;">
4,869
</td>
<td style="text-align:right;">
6,577
</td>
</tr>
<tr>
<td style="text-align:left;">
Bangladeshi
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
89
</td>
</tr>
<tr>
<td style="text-align:left;">
British
</td>
<td style="text-align:right;">
43,375
</td>
<td style="text-align:right;">
132,661
</td>
<td style="text-align:right;">
176,036
</td>
</tr>
<tr>
<td style="text-align:left;">
Caribbean
</td>
<td style="text-align:right;">
660
</td>
<td style="text-align:right;">
1,271
</td>
<td style="text-align:right;">
1,931
</td>
</tr>
<tr>
<td style="text-align:left;">
Chinese
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
470
</td>
<td style="text-align:right;">
643
</td>
</tr>
<tr>
<td style="text-align:left;">
Do not know
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
75
</td>
</tr>
<tr>
<td style="text-align:left;">
Indian
</td>
<td style="text-align:right;">
709
</td>
<td style="text-align:right;">
1,913
</td>
<td style="text-align:right;">
2,622
</td>
</tr>
<tr>
<td style="text-align:left;">
Irish
</td>
<td style="text-align:right;">
1,500
</td>
<td style="text-align:right;">
3,913
</td>
<td style="text-align:right;">
5,413
</td>
</tr>
<tr>
<td style="text-align:left;">
Other ethnic group
</td>
<td style="text-align:right;">
505
</td>
<td style="text-align:right;">
1,424
</td>
<td style="text-align:right;">
1,929
</td>
</tr>
<tr>
<td style="text-align:left;">
Pakistani
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
637
</td>
<td style="text-align:right;">
776
</td>
</tr>
<tr>
<td style="text-align:left;">
Prefer not to answer
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
542
</td>
<td style="text-align:right;">
719
</td>
</tr>
<tr>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
226
</td>
</tr>
<tr>
<td style="text-align:left;">
White
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
225
</td>
</tr>
<tr>
<td style="text-align:left;">
White and Asian
</td>
<td style="text-align:right;">
106
</td>
<td style="text-align:right;">
264
</td>
<td style="text-align:right;">
370
</td>
</tr>
<tr>
<td style="text-align:left;">
White and Black African
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
174
</td>
</tr>
<tr>
<td style="text-align:left;">
White and Black Caribbean
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
198
</td>
<td style="text-align:right;">
294
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
Total
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
49,956
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
150,687
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
200,643
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>For our QC pipeline, we first perform a collection of careful <a href="https://github.com/lindgrengroup/ukb_wes_qc">QC steps</a>. The initial step in this process is to read in the <code>.vcf</code> files, split multiallelics and realign indels, and calculate a collection of sample-level statistics.</p>
<p><br></p>
<div id="initial-sample-filtering" class="section level1">
<h1>Initial sample filtering</h1>
<ul>
<li>Filter out samples based on MAD thresholds.</li>
</ul>
<p><br></p>
</div>
<div id="initial-genotype-filtering" class="section level1">
<h1>Initial genotype filtering</h1>
<p>Our next step (after conversion of the joint called <code>.vcf</code> file to a hail matrix table) is to remove genotypes based on the following collection of criteria:</p>
<ul>
<li>Remove if at least one of the following is true:
<ul>
<li>Genotype quality <span class="math inline">\(&lt;\)</span> 20</li>
<li>Depth <span class="math inline">\(&lt;\)</span> 10</li>
</ul></li>
<li>If heterozygous and a SNP:
<ul>
<li><span class="math inline">\(p\)</span>-value from 1-sided binomial test of alt allele read depth relative to ref+alt read depth <span class="math inline">\(&lt;\)</span> 10<sup>-3</sup></li>
</ul></li>
<li>If heterozygous and an indel:
<ul>
<li>Alternative allele depth divided by total depth <span class="math inline">\(&lt;\)</span> 0.3</li>
</ul></li>
</ul>
<p><br></p>
</div>
<div id="initial-variant-filtering" class="section level1">
<h1>Initial variant filtering</h1>
<p>Remove variants that either:</p>
<ul>
<li>Are invariant after the initial GT filter</li>
<li>Fall in a low complexity region</li>
<li>Fall outside padded target intervals (50bp padding)</li>
<li>Have GATK ExcessHet &gt; 54.69</li>
</ul>
<p>Following this initial curation we perform a series of further QC steps detailed in this repository.</p>
<p>We run the sample_qc function in hail and remove samples according to the following:</p>
<ul>
<li>Sample call rate <span class="math inline">\(&lt;\)</span> 0.95</li>
<li>Mean depth <span class="math inline">\(&lt;\)</span> 19.5</li>
<li>Mean genotype quality <span class="math inline">\(&lt;\)</span> 47.8</li>
</ul>
<p>Thresholds used were based on plotting the distributions of these metrics. Here we show boxplots with overlaid scatterplots of the above metrics, split by UKBB centre, and coloured by sequencing batch. The threshold for exclusion is shown as a dashed line.</p>
<p><img src="plots/200k_03_callRate_by_centre.jpg" width="100%" /><img src="plots/200k_03_dpMean_by_centre.jpg" width="100%" /><img src="plots/200k_03_gqMean_by_centre.jpg" width="100%" /></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Filter
</th>
<th style="text-align:right;font-weight: bold;">
Samples
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Initial samples in vcf
</td>
<td style="text-align:right;">
199,795
</td>
<td style="text-align:right;">
49,759
</td>
<td style="text-align:right;">
150,036
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 100.00%">100.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample call rate &lt; 0.95
</td>
<td style="text-align:right;">
7,400
</td>
<td style="text-align:right;">
4,780
</td>
<td style="text-align:right;">
2,620
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 3.70%">3.7</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean DP &lt; 19.5
</td>
<td style="text-align:right;">
3,253
</td>
<td style="text-align:right;">
511
</td>
<td style="text-align:right;">
2,742
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 1.60%">1.6</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean GQ &lt; 47.8
</td>
<td style="text-align:right;">
2,123
</td>
<td style="text-align:right;">
834
</td>
<td style="text-align:right;">
1,289
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 1.10%">1.1</span>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
Samples after sample QC filters
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
190,924
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
44,846
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
146,078
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 95.60%">95.6</span>
</td>
</tr>
</tbody>
</table>
<p>Following this step, we export genotyped variants on the X chromosome (allele frequency between 0.05 to 0.95 with high call rate (&gt; 0.98)) to plink format and prune to pseudo-independent SNPs using <code>--indep 50 5 2</code>. This pruned set of SNPs feeds into the sex imputation step.</p>
<p><br></p>
</div>
<div id="sex-imputation" class="section level1">
<h1>Sex imputation</h1>
<p>We impute the sexes of the individuals with this pruned set of variants on the X chromosome, and create list of samples with incorrect or unknown sex as defined by:</p>
<ul>
<li>Sex is unknown in the phenotype files</li>
<li><span class="math inline">\(F\)</span>-statistic <span class="math inline">\(&gt;\)</span> 0.6 and the sex is female in the phenotype file</li>
<li><span class="math inline">\(F\)</span>-statistic <span class="math inline">\(&lt;\)</span> 0.6 and the sex is male in the phenotype file</li>
<li><span class="math inline">\(F\)</span>-statistic <span class="math inline">\(&gt;\)</span> 0.6 and number of calls on the Y is <span class="math inline">\(&lt;\)</span> 100.</li>
</ul>
<p>Here we show the distribution of the F-statistic, with the 0.6 threshold defining our sex impututation shown as a dashed line.</p>
<p><img src="plots/04_imputesex_histogram.jpg" width="100%" /><img src="plots/04_imputesex_scatter_box.jpg" width="100%" /></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Filter
</th>
<th style="text-align:right;font-weight: bold;">
Samples
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Samples after sample QC filters
</td>
<td style="text-align:right;">
190,924
</td>
<td style="text-align:right;">
44,846
</td>
<td style="text-align:right;">
146,078
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 100.00%">100</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Samples with sex swap
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 0.00%">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
Samples after sex swap removal
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
190,839
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
44,822
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
146,017
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 100.00%">100</span>
</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="ultra-rare-variant-counts" class="section level1">
<h1>Ultra-rare variant counts</h1>
<p>We next annotate with presence in gnomAD v2 liftover, and determine the number of singletons in the dataset that are not present in gnomAD. We then remove samples that contain over 100.</p>
<p><img src="plots/07_URVs_SNPs_vs_indels_by_NFE.jpg" width="100%" /><img src="plots/07_URVs_by_ethnicity.jpg" width="100%" /></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Samples
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
190,763
</td>
<td style="text-align:right;">
44,816
</td>
<td style="text-align:right;">
145,947
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 100.00%">100.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
13,537
</td>
<td style="text-align:right;">
3,390
</td>
<td style="text-align:right;">
10,147
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 7.10%">7.1</span>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
177,226
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
41,426
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
135,800
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 92.90%">92.9</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="pca-to-classify-non-finnish-europeans" class="section level1">
<h1>PCA to classify non-Finnish Europeans</h1>
<p>We next perform a number of principal component analysis (PCA) steps to ensure that we have subset down to Non-Finnish Europeans. We first run PCA on the 1000 genomes samples (minus the small subset of related individuals within 1000 geneomes). We then project in the UK Biobank samples, ensuring that we correctly account for shrinkage bias in the projection.</p>
<p>We then train a classifier to remove non-Europeans. To do this, we train a random forest on the super populations labels of 1000 genomes and predict the super population for each of the UK Biobank samples. We denote strictly defined European subset as those with probability <span class="math inline">\(&gt;\)</span> 0.99 of being European according to the classifier. UK Biobank samples are coloured by their assignment or unsure if none of the classifier probabilities exceeded 0.99 in the following plots. Another classifier is trained following restriction of the 1000 genomes samples to Europeans to determine non-Finnish Europeans, using a classifier probability of 0.95.</p>
<p>Here is the loose classifier, with no probability restriction on classification:</p>
<p><img src="plots/00_PC1_PC2_classify_EUR_loose_1kg_labelled.jpg" width="100%" /><img src="plots/00_PC3_PC4_classify_EUR_loose_1kg_labelled.jpg" width="100%" /><img src="plots/00_PC5_PC6_classify_EUR_loose_1kg_labelled.jpg" width="100%" /></p>
<p>And here are the resultant classifications after imposing a probability cutoff of 0.99.</p>
<p><img src="plots/00_PC1_PC2_classify_EUR_strict.jpg" width="100%" /><img src="plots/00_PC3_PC4_classify_EUR_strict.jpg" width="100%" /><img src="plots/00_PC5_PC6_classify_EUR_strict.jpg" width="100%" /></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Samples
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
190,763
</td>
<td style="text-align:right;">
44,816
</td>
<td style="text-align:right;">
145,947
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 100.00%">100.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
13,537
</td>
<td style="text-align:right;">
3,390
</td>
<td style="text-align:right;">
10,147
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 7.10%">7.1</span>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
177,226
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
41,426
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
135,800
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 92.90%">92.9</span>
</td>
</tr>
</tbody>
</table>
<p>Samples not assigned to the Non-Finnish European cluster were removed from downstream analysis.</p>
<p><br></p>
</div>
<div id="final-variant-filtering" class="section level1">
<h1>Final variant filtering</h1>
<p>For our final variant filtering step, we first restrict to samples in the strictly defined non-Finnish European subset, filter out samples with incorrectly defined sex or unknown sex, and run variant QC. We then evaluate a collection of variant metrics and remove variants that satisfy at least one of:</p>
<ul>
<li>Invariant site in cleaned sample subset</li>
<li>Call rate <span class="math inline">\(&lt;\)</span> 0.97</li>
<li><span class="math inline">\(p\)</span>HWE <span class="math inline">\(&lt;\)</span> 10<sup>-6</sup></li>
</ul>
<p>The following plots shows the 0.97 threshold for call rate.</p>
<p><img src="plots/200k_08_callRate_hist.jpg" width="100%" /><img src="plots/200k_08_callRate_cdf.jpg" width="100%" /></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Filter
</th>
<th style="text-align:right;font-weight: bold;">
Variants
</th>
<th style="text-align:right;font-weight: bold;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Variants after initial filter
</td>
<td style="text-align:right;">
10,295,000
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 100.00%">100.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Invariant sites after sample filters
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 0.00%">0.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Overall variant call rate &lt; 0.97
</td>
<td style="text-align:right;">
1,122,987
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 10.90%">10.9</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Variants failing HWE filter
</td>
<td style="text-align:right;">
5,237
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 0.10%">0.1</span>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
Variants after filters
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
9,169,408
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 89.10%">89.1</span>
</td>
</tr>
</tbody>
</table>
<p>After these steps we plot the resulting changes in metrics across the samples in our data set. Each of this first set plots splits the data by sequencing batch. The first collection of subplots in each figure shows the variant metrics before sample removal, with the lower collection of subplots showing the resultant change after our QC steps. <img src="plots/09_nSingletons_by_batch.jpg" width="100%" /><img src="plots/09_rHetHomVar_by_batch.jpg" width="100%" /><img src="plots/09_rInsertionDeletion_by_batch.jpg" width="100%" /><img src="plots/09_rTiTv_by_batch.jpg" width="100%" /> Splitting by UKBB centre and colouring by sequencing batch:</p>
<p><img src="plots/09_nSingletons_by_centre.jpg" width="100%" /><img src="plots/09_rHetHomVar_by_centre.jpg" width="100%" /><img src="plots/09_rInsertionDeletion_by_centre.jpg" width="100%" /><img src="plots/09_rTiTv_by_centre.jpg" width="100%" /></p>
<p><br></p>
</div>
<div id="final-sample-filtering" class="section level1">
<h1>Final sample filtering</h1>
<p>In this step we remove sample outliers after the variant cleaning in the previous step. Samples are removed if at least one of the following lies more than four standard deviations away from the mean:</p>
<ul>
<li>Ratio of transitions to transversions</li>
<li>Ratio of heterozygous to homozygous variant</li>
<li>Ratio of insertions to deletions</li>
</ul>
<p>We also remove samples with over 175 singletons in the dataset.</p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
Filter
</th>
<th style="text-align:right;font-weight: bold;">
Samples
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Samples after population filters
</td>
<td style="text-align:right;">
177,226
</td>
<td style="text-align:right;">
41,426
</td>
<td style="text-align:right;">
135,800
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 100.00%">100.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Within batch Ti/Tv ratio outside 4 standard deviations
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 0.00%">0.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Within batch Het/HomVar ratio outside 4 standard deviations
</td>
<td style="text-align:right;">
251
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 0.10%">0.1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Within batch Insertion/Deletion ratio outside 4 standard deviations
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 0.00%">0.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
n singletons &gt; 175
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 0.00%">0.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
Samples after final sample filters
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
176,935
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
41,371
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
135,564
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #0081c2; width: 99.80%">99.8</span>
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>After all of this data cleaning, we save the resultant hail matrix tables for downstream analyses.</p>
<p>The resultant composition of the samples according to UKBB centre and sequencing batch was as follows:</p>
<p><br></p>
<table class="table table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;font-weight: bold;">
UKBB centre
</th>
<th style="text-align:right;font-weight: bold;">
Batch 1
</th>
<th style="text-align:right;font-weight: bold;">
Batch 2
</th>
<th style="text-align:right;font-weight: bold;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Barts
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
3,079
</td>
<td style="text-align:right;">
3,124
</td>
</tr>
<tr>
<td style="text-align:left;">
Birmingham
</td>
<td style="text-align:right;">
7,805
</td>
<td style="text-align:right;">
4,131
</td>
<td style="text-align:right;">
11,936
</td>
</tr>
<tr>
<td style="text-align:left;">
Bristol
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
13,892
</td>
<td style="text-align:right;">
13,985
</td>
</tr>
<tr>
<td style="text-align:left;">
Bury
</td>
<td style="text-align:right;">
1,544
</td>
<td style="text-align:right;">
8,250
</td>
<td style="text-align:right;">
9,794
</td>
</tr>
<tr>
<td style="text-align:left;">
Cardiff
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
5,812
</td>
<td style="text-align:right;">
5,892
</td>
</tr>
<tr>
<td style="text-align:left;">
Croydon
</td>
<td style="text-align:right;">
5,248
</td>
<td style="text-align:right;">
5,068
</td>
<td style="text-align:right;">
10,316
</td>
</tr>
<tr>
<td style="text-align:left;">
Edinburgh
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
5,353
</td>
<td style="text-align:right;">
5,406
</td>
</tr>
<tr>
<td style="text-align:left;">
Glasgow
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
5,665
</td>
<td style="text-align:right;">
5,750
</td>
</tr>
<tr>
<td style="text-align:left;">
Hounslow
</td>
<td style="text-align:right;">
3,948
</td>
<td style="text-align:right;">
5,764
</td>
<td style="text-align:right;">
9,712
</td>
</tr>
<tr>
<td style="text-align:left;">
Leeds
</td>
<td style="text-align:right;">
1,841
</td>
<td style="text-align:right;">
13,026
</td>
<td style="text-align:right;">
14,867
</td>
</tr>
<tr>
<td style="text-align:left;">
Liverpool
</td>
<td style="text-align:right;">
4,246
</td>
<td style="text-align:right;">
8,430
</td>
<td style="text-align:right;">
12,676
</td>
</tr>
<tr>
<td style="text-align:left;">
Manchester
</td>
<td style="text-align:right;">
1,534
</td>
<td style="text-align:right;">
3,442
</td>
<td style="text-align:right;">
4,976
</td>
</tr>
<tr>
<td style="text-align:left;">
Middlesborough
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
6,660
</td>
<td style="text-align:right;">
6,750
</td>
</tr>
<tr>
<td style="text-align:left;">
Newcastle
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
11,565
</td>
<td style="text-align:right;">
11,696
</td>
</tr>
<tr>
<td style="text-align:left;">
Nottingham
</td>
<td style="text-align:right;">
1,407
</td>
<td style="text-align:right;">
9,960
</td>
<td style="text-align:right;">
11,367
</td>
</tr>
<tr>
<td style="text-align:left;">
Oxford
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
4,655
</td>
<td style="text-align:right;">
4,695
</td>
</tr>
<tr>
<td style="text-align:left;">
Reading
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
9,011
</td>
<td style="text-align:right;">
9,065
</td>
</tr>
<tr>
<td style="text-align:left;">
Sheffield
</td>
<td style="text-align:right;">
12,239
</td>
<td style="text-align:right;">
4,911
</td>
<td style="text-align:right;">
17,150
</td>
</tr>
<tr>
<td style="text-align:left;">
Stockport (pilot)
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
64
</td>
</tr>
<tr>
<td style="text-align:left;">
Stoke
</td>
<td style="text-align:right;">
747
</td>
<td style="text-align:right;">
6,011
</td>
<td style="text-align:right;">
6,758
</td>
</tr>
<tr>
<td style="text-align:left;">
Swansea
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
709
</td>
<td style="text-align:right;">
720
</td>
</tr>
<tr>
<td style="text-align:left;">
Wrexham
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
236
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
Total
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
41,371
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
135,564
</td>
<td style="text-align:right;font-weight: bold;color: white !important;background-color: #0C6EBE !important;">
176,935
</td>
</tr>
</tbody>
</table>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
